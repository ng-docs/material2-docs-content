import { __awaiter } from "tslib";
import { TestBed, waitForAsync } from '@angular/core/testing';
import { TestbedHarnessEnvironment } from '@angular/cdk/testing/testbed';
import { MatTableHarness } from '@angular/material/table/testing';
import { parallel } from '@angular/cdk/testing';
import { BrowserDynamicTestingModule, platformBrowserDynamicTesting } from '@angular/platform-browser-dynamic/testing';
import { MatTableModule } from '@angular/material/table';
import { TableHarnessExample } from './table-harness-example';
describe('TableHarnessExample', () => {
    let fixture;
    let loader;
    beforeAll(() => {
        TestBed.initTestEnvironment(BrowserDynamicTestingModule, platformBrowserDynamicTesting());
    });
    beforeEach(waitForAsync(() => {
        TestBed.configureTestingModule({
            imports: [MatTableModule],
            declarations: [TableHarnessExample]
        }).compileComponents();
        fixture = TestBed.createComponent(TableHarnessExample);
        fixture.detectChanges();
        loader = TestbedHarnessEnvironment.loader(fixture);
    }));
    it('should load harness for a table', () => __awaiter(void 0, void 0, void 0, function* () {
        const tables = yield loader.getAllHarnesses(MatTableHarness);
        expect(tables.length).toBe(1);
    }));
    it('should get the different kinds of rows in the table', () => __awaiter(void 0, void 0, void 0, function* () {
        const table = yield loader.getHarness(MatTableHarness);
        const headerRows = yield table.getHeaderRows();
        const footerRows = yield table.getFooterRows();
        const rows = yield table.getRows();
        expect(headerRows.length).toBe(1);
        expect(footerRows.length).toBe(1);
        expect(rows.length).toBe(10);
    }));
    it('should get cells inside a row', () => __awaiter(void 0, void 0, void 0, function* () {
        const table = yield loader.getHarness(MatTableHarness);
        const headerRows = yield table.getHeaderRows();
        const footerRows = yield table.getFooterRows();
        const rows = yield table.getRows();
        const headerCells = (yield parallel(() => headerRows.map(row => row.getCells())))
            .map(row => row.length);
        const footerCells = (yield parallel(() => footerRows.map(row => row.getCells())))
            .map(row => row.length);
        const cells = (yield parallel(() => rows.map(row => row.getCells())))
            .map(row => row.length);
        expect(headerCells).toEqual([4]);
        expect(cells).toEqual([4, 4, 4, 4, 4, 4, 4, 4, 4, 4]);
        expect(footerCells).toEqual([4]);
    }));
    it('should be able to get the text of a cell', () => __awaiter(void 0, void 0, void 0, function* () {
        const table = yield loader.getHarness(MatTableHarness);
        const secondRow = (yield table.getRows())[1];
        const cells = yield secondRow.getCells();
        const cellTexts = yield parallel(() => cells.map(cell => cell.getText()));
        expect(cellTexts).toEqual(['2', 'Helium', '4.0026', 'He']);
    }));
    it('should be able to get the column name of a cell', () => __awaiter(void 0, void 0, void 0, function* () {
        const table = yield loader.getHarness(MatTableHarness);
        const fifthRow = (yield table.getRows())[1];
        const cells = yield fifthRow.getCells();
        const cellColumnNames = yield parallel(() => cells.map(cell => cell.getColumnName()));
        expect(cellColumnNames).toEqual(['position', 'name', 'weight', 'symbol']);
    }));
    it('should be able to filter cells by text', () => __awaiter(void 0, void 0, void 0, function* () {
        const table = yield loader.getHarness(MatTableHarness);
        const firstRow = (yield table.getRows())[0];
        const cells = yield firstRow.getCells({ text: '1.0079' });
        const cellTexts = yield parallel(() => cells.map(cell => cell.getText()));
        expect(cellTexts).toEqual(['1.0079']);
    }));
    it('should be able to filter cells by column name', () => __awaiter(void 0, void 0, void 0, function* () {
        const table = yield loader.getHarness(MatTableHarness);
        const firstRow = (yield table.getRows())[0];
        const cells = yield firstRow.getCells({ columnName: 'symbol' });
        const cellTexts = yield parallel(() => cells.map(cell => cell.getText()));
        expect(cellTexts).toEqual(['H']);
    }));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFibGUtaGFybmVzcy1leGFtcGxlLnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy1leGFtcGxlcy9tYXRlcmlhbC90YWJsZS90YWJsZS1oYXJuZXNzL3RhYmxlLWhhcm5lc3MtZXhhbXBsZS5zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsT0FBTyxFQUFvQixZQUFZLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUM5RSxPQUFPLEVBQUMseUJBQXlCLEVBQUMsTUFBTSw4QkFBOEIsQ0FBQztBQUN2RSxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0saUNBQWlDLENBQUM7QUFDaEUsT0FBTyxFQUFnQixRQUFRLEVBQUMsTUFBTSxzQkFBc0IsQ0FBQztBQUM3RCxPQUFPLEVBQUMsMkJBQTJCLEVBQUUsNkJBQTZCLEVBQUMsTUFDNUQsMkNBQTJDLENBQUM7QUFDbkQsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLHlCQUF5QixDQUFDO0FBQ3ZELE9BQU8sRUFBQyxtQkFBbUIsRUFBQyxNQUFNLHlCQUF5QixDQUFDO0FBRTVELFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7SUFDbkMsSUFBSSxPQUE4QyxDQUFDO0lBQ25ELElBQUksTUFBcUIsQ0FBQztJQUUxQixTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2IsT0FBTyxDQUFDLG1CQUFtQixDQUFDLDJCQUEyQixFQUFFLDZCQUE2QixFQUFFLENBQUMsQ0FBQztJQUM1RixDQUFDLENBQUMsQ0FBQztJQUVILFVBQVUsQ0FDUixZQUFZLENBQUMsR0FBRyxFQUFFO1FBQ2hCLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQztZQUM3QixPQUFPLEVBQUUsQ0FBQyxjQUFjLENBQUM7WUFDekIsWUFBWSxFQUFFLENBQUMsbUJBQW1CLENBQUM7U0FDcEMsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDdkIsT0FBTyxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUN2RCxPQUFPLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDeEIsTUFBTSxHQUFHLHlCQUF5QixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNyRCxDQUFDLENBQUMsQ0FDSCxDQUFDO0lBRUYsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEdBQVMsRUFBRTtRQUMvQyxNQUFNLE1BQU0sR0FBRyxNQUFNLE1BQU0sQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDN0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDaEMsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRSxHQUFTLEVBQUU7UUFDbkUsTUFBTSxLQUFLLEdBQUcsTUFBTSxNQUFNLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ3ZELE1BQU0sVUFBVSxHQUFHLE1BQU0sS0FBSyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQy9DLE1BQU0sVUFBVSxHQUFHLE1BQU0sS0FBSyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQy9DLE1BQU0sSUFBSSxHQUFHLE1BQU0sS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ25DLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xDLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQy9CLENBQUMsQ0FBQSxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsK0JBQStCLEVBQUUsR0FBUyxFQUFFO1FBQzdDLE1BQU0sS0FBSyxHQUFHLE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUN2RCxNQUFNLFVBQVUsR0FBRyxNQUFNLEtBQUssQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUMvQyxNQUFNLFVBQVUsR0FBRyxNQUFNLEtBQUssQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUMvQyxNQUFNLElBQUksR0FBRyxNQUFNLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNuQyxNQUFNLFdBQVcsR0FBRyxDQUFDLE1BQU0sUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO2FBQzlFLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMxQixNQUFNLFdBQVcsR0FBRyxDQUFDLE1BQU0sUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO2FBQzlFLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMxQixNQUFNLEtBQUssR0FBRyxDQUFDLE1BQU0sUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO2FBQ2xFLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUUxQixNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFF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QyxFQUFDLFVBQVUsRUFBRSxRQUFRLEVBQUMsQ0FBQyxDQUFDO1FBQzlELE1BQU0sU0FBUyxHQUFHLE1BQU0sUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzFFLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ25DLENBQUMsQ0FBQSxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7VGVzdEJlZCwgQ29tcG9uZW50Rml4dHVyZSwgd2FpdEZvckFzeW5jfSBmcm9tICdAYW5ndWxhci9jb3JlL3Rlc3RpbmcnO1xuaW1wb3J0IHtUZXN0YmVkSGFybmVzc0Vudmlyb25tZW50fSBmcm9tICdAYW5ndWxhci9jZGsvdGVzdGluZy90ZXN0YmVkJztcbmltcG9ydCB7TWF0VGFibGVIYXJuZXNzfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC90YWJsZS90ZXN0aW5nJztcbmltcG9ydCB7SGFybmVzc0xvYWRlciwgcGFyYWxsZWx9IGZyb20gJ0Bhbmd1bGFyL2Nkay90ZXN0aW5nJztcbmltcG9ydCB7QnJvd3NlckR5bmFtaWNUZXN0aW5nTW9kdWxlLCBwbGF0Zm9ybUJyb3dzZXJEeW5hbWljVGVzdGluZ31cbiAgZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlci1keW5hbWljL3Rlc3RpbmcnO1xuaW1wb3J0IHtNYXRUYWJsZU1vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvdGFibGUnO1xuaW1wb3J0IHtUYWJsZUhhcm5lc3NFeGFtcGxlfSBmcm9tICcuL3RhYmxlLWhhcm5lc3MtZXhhbXBsZSc7XG5cbmRlc2NyaWJlKCdUYWJsZUhhcm5lc3NFeGFtcGxlJywgKCkgPT4ge1xuICBsZXQgZml4dHVyZTogQ29tcG9uZW50Rml4dHVyZTxUYWJsZUhhcm5lc3NFeGFtcGxlPjtcbiAgbGV0IGxvYWRlcjogSGFybmVzc0xvYWRlcjtcblxuICBiZWZvcmVBbGwoKCkgPT4ge1xuICAgIFRlc3RCZWQuaW5pdFRlc3RFbnZpcm9ubWVudChCcm93c2VyRHluYW1pY1Rlc3RpbmdNb2R1bGUsIHBsYXRmb3JtQnJvd3NlckR5bmFtaWNUZXN0aW5nKCkpO1xuICB9KTtcblxuICBiZWZvcmVFYWNoKFxuICAgIHdhaXRGb3JBc3luYygoKSA9PiB7XG4gICAgICBUZXN0QmVkLmNvbmZpZ3VyZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgICBpbXBvcnRzOiBbTWF0VGFibGVNb2R1bGVdLFxuICAgICAgICBkZWNsYXJhdGlvbnM6IFtUYWJsZUhhcm5lc3NFeGFtcGxlXVxuICAgICAgfSkuY29tcGlsZUNvbXBvbmVudHMoKTtcbiAgICAgIGZpeHR1cmUgPSBUZXN0QmVkLmNyZWF0ZUNvbXBvbmVudChUYWJsZUhhcm5lc3NFeGFtcGxlKTtcbiAgICAgIGZpeHR1cmUuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgbG9hZGVyID0gVGVzdGJlZEhhcm5lc3NFbnZpcm9ubWVudC5sb2FkZXIoZml4dHVyZSk7XG4gICAgfSlcbiAgKTtcblxuICBpdCgnc2hvdWxkIGxvYWQgaGFybmVzcyBmb3IgYSB0YWJsZScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0YWJsZXMgPSBhd2FpdCBsb2FkZXIuZ2V0QWxsSGFybmVzc2VzKE1hdFRhYmxlSGFybmVzcyk7XG4gICAgZXhwZWN0KHRhYmxlcy5sZW5ndGgpLnRvQmUoMSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZ2V0IHRoZSBkaWZmZXJlbnQga2luZHMgb2Ygcm93cyBpbiB0aGUgdGFibGUnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgdGFibGUgPSBhd2FpdCBsb2FkZXIuZ2V0SGFybmVzcyhNYXRUYWJsZUhhcm5lc3MpO1xuICAgIGNvbnN0IGhlYWRlclJvd3MgPSBhd2FpdCB0YWJsZS5nZXRIZWFkZXJSb3dzKCk7XG4gICAgY29uc3QgZm9vdGVyUm93cyA9IGF3YWl0IHRhYmxlLmdldEZvb3RlclJvd3MoKTtcbiAgICBjb25zdCByb3dzID0gYXdhaXQgdGFibGUuZ2V0Um93cygpO1xuICAgIGV4cGVjdChoZWFkZXJSb3dzLmxlbmd0aCkudG9CZSgxKTtcbiAgICBleHBlY3QoZm9vdGVyUm93cy5sZW5ndGgpLnRvQmUoMSk7XG4gICAgZXhwZWN0KHJvd3MubGVuZ3RoKS50b0JlKDEwKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBnZXQgY2VsbHMgaW5zaWRlIGEgcm93JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRhYmxlID0gYXdhaXQgbG9hZGVyLmdldEhhcm5lc3MoTWF0VGFibGVIYXJuZXNzKTtcbiAgICBjb25zdCBoZWFkZXJSb3dzID0gYXdhaXQgdGFibGUuZ2V0SGVhZGVyUm93cygpO1xuICAgIGNvbnN0IGZvb3RlclJvd3MgPSBhd2FpdCB0YWJsZS5nZXRGb290ZXJSb3dzKCk7XG4gICAgY29uc3Qgcm93cyA9IGF3YWl0IHRhYmxlLmdldFJvd3MoKTtcbiAgICBjb25zdCBoZWFkZXJDZWxscyA9IChhd2FpdCBwYXJhbGxlbCgoKSA9PiBoZWFkZXJSb3dzLm1hcChyb3cgPT4gcm93LmdldENlbGxzKCkpKSlcbiAgICAgIC5tYXAocm93ID0+IHJvdy5sZW5ndGgpO1xuICAgIGNvbnN0IGZvb3RlckNlbGxzID0gKGF3YWl0IHBhcmFsbGVsKCgpID0+IGZvb3RlclJvd3MubWFwKHJvdyA9PiByb3cuZ2V0Q2VsbHMoKSkpKVxuICAgICAgLm1hcChyb3cgPT4gcm93Lmxlbmd0aCk7XG4gICAgY29uc3QgY2VsbHMgPSAoYXdhaXQgcGFyYWxsZWwoKCkgPT4gcm93cy5tYXAocm93ID0+IHJvdy5nZXRDZWxscygpKSkpXG4gICAgICAubWFwKHJvdyA9PiByb3cubGVuZ3RoKTtcblxuICAgIGV4cGVjdChoZWFkZXJDZWxscykudG9FcXVhbChbNF0pO1xuICAgIGV4cGVjdChjZWxscykudG9FcXVhbChbNCwgNCwgNCwgNCwgNCwgNCwgNCwgNCwgNCwgNF0pO1xuICAgIGV4cGVjdChmb290ZXJDZWxscykudG9FcXVhbChbNF0pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gZ2V0IHRoZSB0ZXh0IG9mIGEgY2VsbCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0YWJsZSA9IGF3YWl0IGxvYWRlci5nZXRIYXJuZXNzKE1hdFRhYmxlSGFybmVzcyk7XG4gICAgY29uc3Qgc2Vjb25kUm93ID0gKGF3YWl0IHRhYmxlLmdldFJvd3MoKSlbMV07XG4gICAgY29uc3QgY2VsbHMgPSBhd2FpdCBzZWNvbmRSb3cuZ2V0Q2VsbHMoKTtcbiAgICBjb25zdCBjZWxsVGV4dHMgPSBhd2FpdCBwYXJhbGxlbCgoKSA9PiBjZWxscy5tYXAoY2VsbCA9PiBjZWxsLmdldFRleHQoKSkpO1xuICAgIGV4cGVjdChjZWxsVGV4dHMpLnRvRXF1YWwoWycyJywgJ0hlbGl1bScsICc0LjAwMjYnLCAnSGUnXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgYWJsZSB0byBnZXQgdGhlIGNvbHVtbiBuYW1lIG9mIGEgY2VsbCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0YWJsZSA9IGF3YWl0IGxvYWRlci5nZXRIYXJuZXNzKE1hdFRhYmxlSGFybmVzcyk7XG4gICAgY29uc3QgZmlmdGhSb3cgPSAoYXdhaXQgdGFibGUuZ2V0Um93cygpKVsxXTtcbiAgICBjb25zdCBjZWxscyA9IGF3YWl0IGZpZnRoUm93LmdldENlbGxzKCk7XG4gICAgY29uc3QgY2VsbENvbHVtbk5hbWVzID0gYXdhaXQgcGFyYWxsZWwoKCkgPT4gY2VsbHMubWFwKGNlbGwgPT4gY2VsbC5nZXRDb2x1bW5OYW1lKCkpKTtcbiAgICBleHBlY3QoY2VsbENvbHVtbk5hbWVzKS50b0VxdWFsKFsncG9zaXRpb24nLCAnbmFtZScsICd3ZWlnaHQnLCAnc3ltYm9sJ10pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gZmlsdGVyIGNlbGxzIGJ5IHRleHQnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgdGFibGUgPSBhd2FpdCBsb2FkZXIuZ2V0SGFybmVzcyhNYXRUYWJsZUhhcm5lc3MpO1xuICAgIGNvbnN0IGZpcnN0Um93ID0gKGF3YWl0IHRhYmxlLmdldFJvd3MoKSlbMF07XG4gICAgY29uc3QgY2VsbHMgPSBhd2FpdCBmaXJzdFJvdy5nZXRDZWxscyh7dGV4dDogJzEuMDA3OSd9KTtcbiAgICBjb25zdCBjZWxsVGV4dHMgPSBhd2FpdCBwYXJhbGxlbCgoKSA9PiBjZWxscy5tYXAoY2VsbCA9PiBjZWxsLmdldFRleHQoKSkpO1xuICAgIGV4cGVjdChjZWxsVGV4dHMpLnRvRXF1YWwoWycxLjAwNzknXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgYWJsZSB0byBmaWx0ZXIgY2VsbHMgYnkgY29sdW1uIG5hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgdGFibGUgPSBhd2FpdCBsb2FkZXIuZ2V0SGFybmVzcyhNYXRUYWJsZUhhcm5lc3MpO1xuICAgIGNvbnN0IGZpcnN0Um93ID0gKGF3YWl0IHRhYmxlLmdldFJvd3MoKSlbMF07XG4gICAgY29uc3QgY2VsbHMgPSBhd2FpdCBmaXJzdFJvdy5nZXRDZWxscyh7Y29sdW1uTmFtZTogJ3N5bWJvbCd9KTtcbiAgICBjb25zdCBjZWxsVGV4dHMgPSBhd2FpdCBwYXJhbGxlbCgoKSA9PiBjZWxscy5tYXAoY2VsbCA9PiBjZWxsLmdldFRleHQoKSkpO1xuICAgIGV4cGVjdChjZWxsVGV4dHMpLnRvRXF1YWwoWydIJ10pO1xuICB9KTtcbn0pO1xuIl19